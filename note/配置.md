配置的来源

- 命令行参数

  在程序启动时的命令行提供参数

- 环境变量

  程序运行时所在的实例环境中进行配置。

- 配置文件

  一般包含程序启动时所需最少的配置信息。比如日志配置信息、数据库等中间件配置信息。

- 远程配置中心

  与配置文件互补。配置文件中除了其中时所需的最少配置，其他配置都可以放在这里。



配置来源优先级如下：

1. 命令行参数
2. 实例的环境变量
3. 配置文件
4. 远程配置中心



### 实践

引入viper

 一般的，相关的配置都会定义到一个结构体中，然后初始化整个结构体。

注：不建议在代码中通过viper获取各种配置项。



不同环境下加载不同的配置文件?

在程序启动的参数中加入一个config参数，表示配置文件所在。

```
go run . --config=config/dev.yaml
```



远程配置中心

配置文件缺点难以进行权限控制、复杂的加密解密、实时更新。



